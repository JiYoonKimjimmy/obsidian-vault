## 새해맞이 캠페인 프로모션 상품권 지급
- 1차 누락건 지급
	- 총 건수: 1244건
	- 성공 건수: 1241건
	- 실패 건수: 3건
		- 모두 서비스 미가입자 에러
- 2차 지급
	- 총 건수: 17215건
	- 성공 건수: 17191건
	- 실패 건수: 24건
		- 모두 서비스 미가입자 에러
		- 그 중 3건은 통합 회원 탈퇴 후 재가입으로 `customer_uid` 업데이트된 상태
```
통합 탈퇴 후 재가입하여 customer_uid 변경으로 실패한 회원 목록
1265880 > 1388739('0dc78dbc9e339765bcf73767580bd2e39098b75272e6baffdd5f31405a875e4b')
1220709 > 1290591('697466113890736e3c009c607a4080c42b37c984abeb1a5bcf46489cbc4727bc')
1205834 > 1365416('44691a7cf1da30c7dca6efee8fded91f6a38fe9da9792d45697524e0c44eb5c0')
```

---

```
pipeline {
    agent any

    stages {
        stage('withdraw nice and hecto'){
            parallel {
                // stage('withdraw nice') {
                //     steps {
                //         build job: 'prepay-nicePinWithdrawBatchJob', propagate: true
                //     }
                // }
                stage('withdraw hecto') {
                    steps {
                        build job: 'prepay-hectoAccountWithdrawBatchJob', propagate: true
                    }
                }
            }
        }
        stage('delete money tables'){
            parallel {
                stage('delete from money_charge'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'money'),
                            string(name: 'tableName', value: 'money_charge'),
                            string(name: 'targetKeyName', value: 'money_charge_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_charge_payment'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'money'),
                            string(name: 'tableName', value: 'money_charge_payment'),
                            string(name: 'targetKeyName', value: 'money_charge_payment_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_charge_manual'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'money'),
                            string(name: 'tableName', value: 'money_charge_manual'),
                            string(name: 'targetKeyName', value: 'money_charge_manual_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_list'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'money'),
                            string(name: 'tableName', value: 'money_list'),
                            string(name: 'targetKeyName', value: 'money_list_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from account_event_list'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'money'),
                            string(name: 'tableName', value: 'account_event_list'),
                            string(name: 'targetKeyName', value: 'event_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from voucher_event_list'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'money'),
                            string(name: 'tableName', value: 'voucher_event_list'),
                            string(name: 'targetKeyName', value: 'event_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from manual_event_list'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'money'),
                            string(name: 'tableName', value: 'manual_event_list'),
                            string(name: 'targetKeyName', value: 'event_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_refund'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'money'),
                            string(name: 'tableName', value: 'money_refund'),
                            string(name: 'targetKeyName', value: 'money_refund_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_refund_history'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'money'),
                            string(name: 'tableName', value: 'money_refund_history'),
                            string(name: 'targetKeyName', value: 'money_refund_history_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_refund_manual'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'money'),
                            string(name: 'tableName', value: 'money_refund_manual'),
                            string(name: 'targetKeyName', value: 'money_refund_manual_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_charge_voucher'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'money'),
                            string(name: 'tableName', value: 'money_charge_voucher'),
                            string(name: 'targetKeyName', value: 'money_charge_voucher_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from customer_extended_info'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'money'),
                            string(name: 'tableName', value: 'customer_extended_info'),
                            string(name: 'targetKeyName', value: 'customer_uid'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from promotion_target'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'money'),
                            string(name: 'tableName', value: 'promotion_target'),
                            string(name: 'targetKeyName', value: 'promotion_target_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_customer'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'money'),
                            string(name: 'tableName', value: 'money_customer'),
                            string(name: 'targetKeyName', value: 'ci'),
                            string(name: 'keyType', value: 'STRING')
                        ]
                    }
                }
            }
        }
        stage('clean cache') {
            steps {
                build job: 'prepay-prepayPrivacyCacheCleanUpBatchJob', propagate: true
            }
        }
        stage('delete member tables'){
            parallel {
                stage('delete from customer'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'member'),
                            string(name: 'tableName', value: 'customer'),
                            string(name: 'targetKeyName', value: 'customer_uid'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from customer_history'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'member'),
                            string(name: 'tableName', value: 'customer_history'),
                            string(name: 'targetKeyName', value: 'customer_history_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from customer_prison'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'member'),
                            string(name: 'tableName', value: 'customer_prison'),
                            string(name: 'targetKeyName', value: 'customer_prison_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from customer_service'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'member'),
                            string(name: 'tableName', value: 'customer_service'),
                            string(name: 'targetKeyName', value: 'customer_service_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from merchant_customer'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'member'),
                            string(name: 'tableName', value: 'merchant_customer'),
                            string(name: 'targetKeyName', value: 'merchant_customer_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from merchant_customer_history'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'member'),
                            string(name: 'tableName', value: 'merchant_customer_history'),
                            string(name: 'targetKeyName', value: 'merchant_customer_history_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from temporary_customer'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'member'),
                            string(name: 'tableName', value: 'temporary_customer'),
                            string(name: 'targetKeyName', value: 'ci'),
                            string(name: 'keyType', value: 'STRING')
                        ]
                    }
                }
            }
        }
        stage('delete aml tables'){
            parallel {
                stage('delete from kyc_customer_master'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'aml'),
                            string(name: 'tableName', value: 'kyc_customer_master'),
                            string(name: 'targetKeyName', value: 'hash_ci'),
                            string(name: 'keyType', value: 'STRING')
                        ]
                    }
                }
                stage('delete from kyc_customer_master_history'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'aml'),
                            string(name: 'tableName', value: 'kyc_customer_master_history'),
                            string(name: 'targetKeyName', value: 'SEQ'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
            }
        }
        stage('delete archive_money tables'){
            parallel {
                stage('delete from account_event_list'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_money'),
                            string(name: 'tableName', value: 'account_event_list'),
                            string(name: 'targetKeyName', value: 'event_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from manual_event_list'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_money'),
                            string(name: 'tableName', value: 'manual_event_list'),
                            string(name: 'targetKeyName', value: 'event_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_charge'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_money'),
                            string(name: 'tableName', value: 'money_charge'),
                            string(name: 'targetKeyName', value: 'money_charge_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_charge_manual'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_money'),
                            string(name: 'tableName', value: 'money_charge_manual'),
                            string(name: 'targetKeyName', value: 'money_charge_manual_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_charge_payment'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_money'),
                            string(name: 'tableName', value: 'money_charge_payment'),
                            string(name: 'targetKeyName', value: 'money_charge_payment_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_charge_voucher'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_money'),
                            string(name: 'tableName', value: 'money_charge_voucher'),
                            string(name: 'targetKeyName', value: 'money_charge_voucher_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_customer'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_money'),
                            string(name: 'tableName', value: 'money_customer'),
                            string(name: 'targetKeyName', value: 'ci'),
                            string(name: 'keyType', value: 'STRING')
                        ]
                    }
                }
                stage('delete from money_list'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_money'),
                            string(name: 'tableName', value: 'money_list'),
                            string(name: 'targetKeyName', value: 'money_list_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_refund'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_money'),
                            string(name: 'tableName', value: 'money_refund'),
                            string(name: 'targetKeyName', value: 'money_refund_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_refund_history'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_money'),
                            string(name: 'tableName', value: 'money_refund_history'),
                            string(name: 'targetKeyName', value: 'money_refund_history_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from money_refund_manual'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_money'),
                            string(name: 'tableName', value: 'money_refund_manual'),
                            string(name: 'targetKeyName', value: 'money_refund_manual_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from voucher_event_list'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_money'),
                            string(name: 'tableName', value: 'voucher_event_list'),
                            string(name: 'targetKeyName', value: 'event_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
            }
        }
        stage('delete archive_member tables'){
            parallel {
                stage('delete from customer'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_member'),
                            string(name: 'tableName', value: 'customer'),
                            string(name: 'targetKeyName', value: 'customer_uid'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
                stage('delete from customer_history'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_member'),
                            string(name: 'tableName', value: 'customer_history'),
                            string(name: 'targetKeyName', value: 'customer_history_id'),
                            string(name: 'keyType', value: 'INT')
                        ]
                    }
                }
            }
        }
        stage('delete archive_voucher tables'){
            parallel {
                stage('delete from issued_voucher_gift_info'){
                    steps {
                        build job: 'prepay-prepayPrivacyDbCleanUpBatch',
                        propagate: true,
                        parameters: [
                            string(name: 'schema', value: 'archive_voucher'),
                            string(name: 'tableName', value: 'issued_voucher_gift_info'),
                            string(name: 'targetKeyName', value: 'transaction_key'),
                            string(name: 'keyType', value: 'STRING')
                        ]
                    }
                }
            }
        }
        stage('pay-mupay-reset') {
            steps {
                build job: 'pay-mupay-reset', propagate: true
            }
        }
    }
}

```